@startuml
title 사용자 인증 객체 다이어그램

object user {
    id = "usr_001"
    email = "john@example.com"
    password = "$2b$10$hashedPassword"
    nickname = "john_study"
    status = "ACTIVE"
    lastLoginAt = "2024-01-15T14:30:00Z"
    failedLoginAttempts = 0
}

object session {
    sessionId = "ses_abc123"
    userId = "usr_001"
    ipAddress = "192.168.1.100"
    userAgent = "Mozilla/5.0..."
    isActive = true
    createdAt = "2024-01-15T14:30:00Z"
    expiresAt = "2024-01-16T14:30:00Z"
}

object accessToken {
    token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    type = "ACCESS_TOKEN"
    userId = "usr_001"
    issuedAt = "2024-01-15T14:30:00Z"
    expiresAt = "2024-01-15T15:30:00Z"
    authorities = ["ROLE_USER"]
}

object refreshToken {
    token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    type = "REFRESH_TOKEN"
    userId = "usr_001"
    issuedAt = "2024-01-15T14:30:00Z"
    expiresAt = "2024-01-22T14:30:00Z"
    isRevoked = false
}

object oauth {
    id = "oa_001"
    userId = "usr_001"
    provider = "GOOGLE"
    providerId = "google_12345"
    email = "john@example.com"
    displayName = "John Doe"
    profileImageUrl = "https://lh3.google.com/..."
    linkedAt = "2024-01-10T09:00:00Z"
}

object loginAudit {
    id = "log_002"
    action = "USER_LOGIN"
    userId = "usr_001"
    ipAddress = "192.168.1.100"
    timestamp = "2024-01-15T14:30:00Z"
    details = "Successful login"
    result = "SUCCESS"
}

object blacklist {
    token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    userId = "usr_001"
    revokedAt = "2024-01-15T16:00:00Z"
    reason = "USER_LOGOUT"
}

user -- session : creates
session -- accessToken : generates
session -- refreshToken : generates
user -- oauth : links
user -- loginAudit : logs
refreshToken -- blacklist : revoked_to

note top of user : 로그인한 활성 사용자
note top of session : 사용자 세션 정보
note top of accessToken : API 접근을 위한 토큰
note top of refreshToken : 토큰 갱신을 위한 토큰

@enduml
